const AWS = require('aws-sdk');
const ethers = require('ethers');

const awsWalletKey = process.env.pvtkey


// retrieve param from ssm parameter store
const getSSMParam  = async (name) => {
    const ssm = new (require('aws-sdk/clients/ssm'))()
    const param = {
      Name: name,
      WithDecryption: true
    };
    const retrievedParam = await ssm.getParameter(param).promise();
    return retrievedParam.Parameter.Value;
}

const getAWSWallet = async (provider, ssmKey = awsWalletKey) => {
  const pvt = await getSSMParam(ssmKey)
  const myWallet = new ethers.Wallet(pvt, provider);

  return myWallet
}

module.exports = { getAWSWallet }